{"version":3,"sources":["p2p.ts","module/PeerConnection/PeerConnection.tsx","styles/normalizeCss.ts","styles/globalStyle.ts","components/Button/Button.ts","assets/logo.svg","components/Header/Header.tsx","components/Footer/Footer.tsx","types/MessageSenderEnum.ts","types/MessageTypeEnum.ts","module/ChatMessages/ChatMessages.tsx","module/useChat/useChat.ts","components/Chat/ChatMessage.tsx","components/TextArea/TextArea.ts","components/Chat/Chat.tsx","util/connectionDescriptionValidator.ts","util/connectionDescriptionEncoding.ts","components/HostOrSlave/HostOrSlave.tsx","components/Host/Host.tsx","components/Slave/Slave.tsx","assets/message_undraw.svg","assets/share_undraw.svg","App.tsx","index.tsx"],"names":["createPeerConnection","channelInstance","remoteDescription","iceServers","urls","username","credential","onChannelOpen","onMessageReceived","onDisconnect","peerConnection","RTCPeerConnection","a","createOffer","description","setLocalDescription","setRemoteDescription","JSON","parse","createAnswer","setAnswerDescription","answerDescription","sendMessage","message","send","Promise","res","onicecandidate","e","candidate","localDescription","sdp","replace","stringify","oniceconnectionstatechange","iceConnectionState","ondatachannel","channel","onopen","onmessage","event","data","createDataChannel","console","error","setupChannelAsAHost","PEER_CONNECTION_MODE","peerConnectionSubject","Subject","PeerConnectionContext","createContext","PeerConnectionProvider","children","useState","undefined","mode","setMode","isConnected","setIsConnected","peerConnectionRef","useRef","useCallback","messageString","next","startAsHost","HOST","current","Base64","encode","startAsSlave","connectionDescription","SLAVE","decode","setRemoteConnectionDescription","localConnectionDescription","useMemo","Provider","value","normalizeCss","css","GlobalStyle","createGlobalStyle","Button","styled","button","props","hide","LogoPlay","div","Header","onClickButton","hideButton","href","src","logo","onClick","MESSAGE_SENDER","MESSAGE_TYPE","CenteredFooter","Footer","memo","target","chatMessagesSubject","ReplaySubject","ChatMessagesContext","useChatMessages","useContext","chatMessages","setChatMessages","useEffect","subscription","subscribe","chatMessage","unsubscribe","sendChatMessage","useChat","usePeerConnection","sendTextChatMessage","messageText","id","shortid","generate","sender","STRANGER","type","TEXT","timestamp","Date","payload","ME","text","useChatPeerConnectionSubscription","usePeerConnectionSubscription","Text","Message","ChatTextMessage","toLocaleTimeString","ChatMessage","TextArea","textarea","MessageButton","MessageTextArea","MessageForm","form","MessagesInnerContainer","MessagesContainer","Container","Chat","messageToSend","setMessageToSend","formRef","handleTextAreaChange","preventDefault","stopPropagation","handleTextAreaKeyDown","which","keyCode","shiftKey","handleSubmit","map","ref","onSubmit","placeholder","onChange","onKeyDown","connectionDescriptionValidator","createValidator","d","length","connectionDescriptionCode","InvitationTextArea","SlaveButton","ErrorMessage","Form","Card","ModalContainer","ModalHalf","Or","HostOrSlave","React","setConnectionDescription","setError","connectionDescriptionObject","Error","StyledTextArea","Instruction","Step","Host","remoteConnectionDescriptionInputValue","setRemoteConnectionDescriptionInputValue","copyTextAreaRef","createRef","encodedConnectionDescription","readOnly","select","copy","CopyButton","Slave","InnerWrapper","Wrapper","FlexContainer","reversed","TextContainer","App","isModalOpen","setModalOpen","share","style","content","height","top","left","right","bottom","padding","marginRight","transform","isOpen","onRequestClose","contentLabel","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.a5b5ad87.chunk.js","sourcesContent":["/* eslint-disable @typescript-eslint/no-use-before-define */\nconst CHANNEL_LABEL = 'RTCHESS_CHANNEL_LABEL';\n\nexport interface CreatePeerConnectionProps {\n  remoteDescription?: string;\n  iceServers?: RTCIceServer[];\n  onChannelOpen: () => any;\n  onMessageReceived: (message: string) => any;\n  onDisconnect: () => any;\n}\n\nexport interface CreatePeerConnectionResponse {\n  localDescription: string;\n  setAnswerDescription: (answerDescription: string) => void;\n  sendMessage: (message: string) => void;\n}\n\nexport function createPeerConnection({\n  remoteDescription,\n  iceServers = [\n    {\n      urls: 'stun:stun.l.google.com:19302',\n    },\n    {\n      urls: 'turn:turn.anyfirewall.com:443?transport=tcp',\n      username: 'webrtc',\n      credential: 'webrtc',\n    },\n  ],\n  onChannelOpen,\n  onMessageReceived,\n  onDisconnect,\n}: CreatePeerConnectionProps): Promise<CreatePeerConnectionResponse> {\n  const peerConnection = new RTCPeerConnection({\n    iceServers,\n  });\n  let channelInstance: RTCDataChannel;\n\n  function setupChannelAsAHost() {\n    try {\n      channelInstance = peerConnection.createDataChannel(CHANNEL_LABEL);\n\n      channelInstance.onopen = function () {\n        onChannelOpen();\n      };\n\n      channelInstance.onmessage = function (event) {\n        onMessageReceived(event.data);\n      };\n    } catch (e) {\n      console.error('No data channel (peerConnection)', e);\n    }\n  }\n\n  async function createOffer() {\n    const description = await peerConnection.createOffer();\n    peerConnection.setLocalDescription(description);\n  }\n\n  function setupChannelAsASlave() {\n    peerConnection.ondatachannel = function ({ channel }) {\n      channelInstance = channel;\n      channelInstance.onopen = function () {\n        onChannelOpen();\n      };\n\n      channelInstance.onmessage = function (event) {\n        onMessageReceived(event.data);\n      };\n    };\n  }\n\n  async function createAnswer(remoteDescription: string) {\n    await peerConnection.setRemoteDescription(JSON.parse(remoteDescription));\n    const description = await peerConnection.createAnswer();\n    peerConnection.setLocalDescription(description);\n  }\n\n  function setAnswerDescription(answerDescription: string) {\n    peerConnection.setRemoteDescription(JSON.parse(answerDescription));\n  }\n\n  function sendMessage(message: string) {\n    if (channelInstance) {\n      channelInstance.send(message);\n    }\n  }\n\n  return new Promise((res) => {\n    peerConnection.onicecandidate = function (e) {\n      if (e.candidate === null && peerConnection.localDescription) {\n        peerConnection.localDescription.sdp.replace('b=AS:30', 'b=AS:1638400');\n        res({\n          localDescription: JSON.stringify(peerConnection.localDescription),\n          setAnswerDescription,\n          sendMessage,\n        });\n      }\n    };\n    \n    peerConnection.oniceconnectionstatechange = function() {\n      if(peerConnection.iceConnectionState == 'disconnected') {\n          onDisconnect();\n      }\n    }\n\n\n    if (!remoteDescription) {\n      setupChannelAsAHost();\n      createOffer();\n    } else {\n      setupChannelAsASlave();\n      createAnswer(remoteDescription);\n    }\n  });\n}\n","import React, { createContext, FC, useState, useRef, useCallback, useEffect, useContext, useMemo } from 'react';\nimport { Subject } from 'rxjs';\nimport { Base64 } from 'js-base64';\n\nimport { createPeerConnection, CreatePeerConnectionResponse } from '../../p2p';\n\nexport type ConnectionDescription = {\n  description: string;\n};\nexport enum PEER_CONNECTION_MODE {\n  HOST = 'HOST',\n  SLAVE = 'SLAVE',\n}\n\nconst iceServers: RTCIceServer[] = [\n  {\n    urls: 'stun:stun.l.google.com:19302',\n  },\n  // {\n  //   urls: 'turn:turn.anyfirewall.com:443?transport=tcp',\n  //   username: 'webrtc',\n  //   credential: 'webrtc',\n  // },\n];\n\nconst peerConnectionSubject = new Subject<any>();\n\ninterface PeerConnectionContextValue {\n  mode: PEER_CONNECTION_MODE | undefined;\n  isConnected: boolean;\n  localConnectionDescription: ConnectionDescription | undefined;\n  startAsHost: () => void;\n  startAsSlave: (connectionDescription: ConnectionDescription) => void;\n  setRemoteConnectionDescription: (connectionDescription: ConnectionDescription) => void;\n  sendMessage: (message: any) => void;\n  peerConnectionSubject: typeof peerConnectionSubject;\n}\n\nconst PeerConnectionContext = createContext<PeerConnectionContextValue>({} as PeerConnectionContextValue);\n\nexport const PeerConnectionProvider: FC = ({ children }) => {\n  const [mode, setMode] = useState<PEER_CONNECTION_MODE | undefined>(undefined);\n  const [localDescription, setLocalDescription] = useState<string | undefined>();\n  const [isConnected, setIsConnected] = useState(false);\n  const peerConnectionRef = useRef<CreatePeerConnectionResponse>();\n\n  const onChannelOpen = useCallback(() => setIsConnected(true), [setIsConnected]);\n  \n  const onDisconnect = useCallback(() => {\n    setIsConnected(false);\n    setMode(undefined);\n  }, [setIsConnected, setMode])\n\n  const onMessageReceived = useCallback((messageString: string) => {\n    try {\n      const message = JSON.parse(messageString);\n      peerConnectionSubject.next(message);\n    } catch (error) {\n      console.error(error);\n    }\n  }, []);\n\n  const startAsHost = useCallback(async () => {\n    if (typeof mode !== 'undefined') return;\n\n    setMode(PEER_CONNECTION_MODE.HOST);\n    peerConnectionRef.current = await createPeerConnection({\n      iceServers,\n      onMessageReceived,\n      onChannelOpen,\n      onDisconnect,\n    });\n\n    setLocalDescription(Base64.encode(peerConnectionRef.current.localDescription));\n  }, [mode, setMode, onMessageReceived, onChannelOpen, setLocalDescription]);\n\n  const startAsSlave = useCallback(\n    async (connectionDescription: ConnectionDescription) => {\n      if (typeof mode !== 'undefined') return;\n\n      setMode(PEER_CONNECTION_MODE.SLAVE);\n\n      peerConnectionRef.current = await createPeerConnection({\n        iceServers,\n        remoteDescription: Base64.decode(connectionDescription.description),\n        onMessageReceived,\n        onChannelOpen,\n        onDisconnect,\n      });\n      setLocalDescription(Base64.encode(peerConnectionRef.current.localDescription));\n    },\n    [mode, setMode, onMessageReceived, onChannelOpen, setLocalDescription],\n  );\n\n  const setRemoteConnectionDescription = useCallback((connectionDescription: ConnectionDescription) => {\n    if (!peerConnectionRef.current) return;\n\n    peerConnectionRef.current.setAnswerDescription(Base64.decode(connectionDescription.description));\n  }, []);\n\n  const sendMessage = useCallback((message) => {\n    if (!peerConnectionRef.current) return;\n\n    const messageString = JSON.stringify(message);\n\n    peerConnectionRef.current.sendMessage(messageString);\n  }, []);\n\n  const localConnectionDescription: ConnectionDescription | undefined = useMemo(\n    () =>\n      localDescription\n        ? {\n            description: localDescription,\n          }\n        : undefined,\n    [localDescription],\n  );\n\n  return (\n    <PeerConnectionContext.Provider\n      value={{\n        mode,\n        isConnected,\n        localConnectionDescription,\n        startAsHost,\n        startAsSlave,\n        setRemoteConnectionDescription,\n        sendMessage,\n        peerConnectionSubject,\n      }}\n    >\n      {children}\n    </PeerConnectionContext.Provider>\n  );\n};\n\nexport const usePeerConnection = <T extends any>() => {\n  const {\n    mode,\n    isConnected,\n    localConnectionDescription,\n    startAsHost,\n    startAsSlave,\n    setRemoteConnectionDescription,\n    sendMessage,\n  } = useContext(PeerConnectionContext);\n\n  return {\n    mode,\n    isConnected,\n    localConnectionDescription,\n    startAsHost,\n    startAsSlave,\n    setRemoteConnectionDescription,\n    sendMessage: sendMessage as (message: T) => void,\n  };\n};\n\nexport const usePeerConnectionSubscription = <T extends any>(onMessageReceived: (message: T) => void) => {\n  const { peerConnectionSubject } = useContext(PeerConnectionContext);\n\n  useEffect(() => {\n    const subscription = (peerConnectionSubject as Subject<T>).subscribe(onMessageReceived);\n\n    return () => subscription.unsubscribe();\n  }, [peerConnectionSubject, onMessageReceived]);\n};\n","import { css } from 'styled-components';\n\nexport const normalizeCss = css`\n  /*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */\n\n  /* Document\n    ========================================================================== */\n\n  /**\n   * 1. Correct the line height in all browsers.\n   * 2. Prevent adjustments of font size after orientation changes in iOS.\n   */\n\n  html {\n    line-height: 1.15; /* 1 */\n    -webkit-text-size-adjust: 100%; /* 2 */\n  }\n\n  /* Sections\n    ========================================================================== */\n\n  /**\n   * Remove the margin in all browsers.\n   */\n\n  body {\n    margin: 0;\n    font-family: 'Source Code Pro', monospace;\n  }\n\n  /**\n   * Render the \"main\" element consistently in IE.\n   */\n\n  main {\n    display: block;\n  }\n\n  /**\n   * Correct the font size and margin on \"h1\" elements within \"section\" and\n   * \"article\" contexts in Chrome, Firefox, and Safari.\n   */\n\n  h1 {\n    font-size: 2em;\n    margin: 0.67em 0;\n  }\n\n  /* Grouping content\n    ========================================================================== */\n\n  /**\n   * 1. Add the correct box sizing in Firefox.\n   * 2. Show the overflow in Edge and IE.\n   */\n\n  hr {\n    box-sizing: content-box; /* 1 */\n    height: 0; /* 1 */\n    overflow: visible; /* 2 */\n  }\n\n  /**\n   * 1. Correct the inheritance and scaling of font size in all browsers.\n   * 2. Correct the odd \"em\" font sizing in all browsers.\n   */\n\n  pre {\n    font-family: monospace, monospace; /* 1 */\n    font-size: 1em; /* 2 */\n  }\n\n  /* Text-level semantics\n    ========================================================================== */\n\n  /**\n   * Remove the gray background on active links in IE 10.\n   */\n\n  a {\n    background-color: transparent;\n  }\n\n  /**\n   * 1. Remove the bottom border in Chrome 57-\n   * 2. Add the correct text decoration in Chrome, Edge, IE, Opera, and Safari.\n   */\n\n  abbr[title] {\n    border-bottom: none; /* 1 */\n    text-decoration: underline; /* 2 */\n    text-decoration: underline dotted; /* 2 */\n  }\n\n  /**\n   * Add the correct font weight in Chrome, Edge, and Safari.\n   */\n\n  b,\n  strong {\n    font-weight: bolder;\n  }\n\n  /**\n   * 1. Correct the inheritance and scaling of font size in all browsers.\n   * 2. Correct the odd \"em\" font sizing in all browsers.\n   */\n\n  code,\n  kbd,\n  samp {\n    font-family: monospace, monospace; /* 1 */\n    font-size: 1em; /* 2 */\n  }\n\n  /**\n   * Add the correct font size in all browsers.\n   */\n\n  small {\n    font-size: 80%;\n  }\n\n  /**\n   * Prevent \"sub\" and \"sup\" elements from affecting the line height in\n   * all browsers.\n   */\n\n  sub,\n  sup {\n    font-size: 75%;\n    line-height: 0;\n    position: relative;\n    vertical-align: baseline;\n  }\n\n  sub {\n    bottom: -0.25em;\n  }\n\n  sup {\n    top: -0.5em;\n  }\n\n  /* Embedded content\n    ========================================================================== */\n\n  /**\n   * Remove the border on images inside links in IE 10.\n   */\n\n  img {\n    border-style: none;\n  }\n\n  /* Forms\n    ========================================================================== */\n\n  /**\n   * 1. Change the font styles in all browsers.\n   * 2. Remove the margin in Firefox and Safari.\n   */\n\n  button,\n  input,\n  optgroup,\n  select,\n  textarea {\n    font-family: inherit; /* 1 */\n    font-size: 100%; /* 1 */\n    line-height: 1.15; /* 1 */\n    margin: 0; /* 2 */\n  }\n\n  /**\n   * Show the overflow in IE.\n   * 1. Show the overflow in Edge.\n   */\n\n  button,\n  input {\n    /* 1 */\n    overflow: visible;\n  }\n\n  /**\n   * Remove the inheritance of text transform in Edge, Firefox, and IE.\n   * 1. Remove the inheritance of text transform in Firefox.\n   */\n\n  button,\n  select {\n    /* 1 */\n    text-transform: none;\n  }\n\n  /**\n   * Correct the inability to style clickable types in iOS and Safari.\n   */\n\n  button,\n  [type='button'],\n  [type='reset'],\n  [type='submit'] {\n    -webkit-appearance: button;\n  }\n\n  /**\n   * Remove the inner border and padding in Firefox.\n   */\n\n  button::-moz-focus-inner,\n  [type='button']::-moz-focus-inner,\n  [type='reset']::-moz-focus-inner,\n  [type='submit']::-moz-focus-inner {\n    border-style: none;\n    padding: 0;\n  }\n\n  /**\n   * Restore the focus styles unset by the previous rule.\n   */\n\n  button:-moz-focusring,\n  [type='button']:-moz-focusring,\n  [type='reset']:-moz-focusring,\n  [type='submit']:-moz-focusring {\n    outline: 1px dotted ButtonText;\n  }\n\n  /**\n   * Correct the padding in Firefox.\n   */\n\n  fieldset {\n    padding: 0.35em 0.75em 0.625em;\n  }\n\n  /**\n   * 1. Correct the text wrapping in Edge and IE.\n   * 2. Correct the color inheritance from \"fieldset\" elements in IE.\n   * 3. Remove the padding so developers are not caught out when they zero out\n   *    \"fieldset\" elements in all browsers.\n   */\n\n  legend {\n    box-sizing: border-box; /* 1 */\n    color: inherit; /* 2 */\n    display: table; /* 1 */\n    max-width: 100%; /* 1 */\n    padding: 0; /* 3 */\n    white-space: normal; /* 1 */\n  }\n\n  /**\n   * Add the correct vertical alignment in Chrome, Firefox, and Opera.\n   */\n\n  progress {\n    vertical-align: baseline;\n  }\n\n  /**\n   * Remove the default vertical scrollbar in IE 10+.\n   */\n\n  textarea {\n    overflow: auto;\n  }\n\n  /**\n   * 1. Add the correct box sizing in IE 10.\n   * 2. Remove the padding in IE 10.\n   */\n\n  [type='checkbox'],\n  [type='radio'] {\n    box-sizing: border-box; /* 1 */\n    padding: 0; /* 2 */\n  }\n\n  /**\n   * Correct the cursor style of increment and decrement buttons in Chrome.\n   */\n\n  [type='number']::-webkit-inner-spin-button,\n  [type='number']::-webkit-outer-spin-button {\n    height: auto;\n  }\n\n  /**\n   * 1. Correct the odd appearance in Chrome and Safari.\n   * 2. Correct the outline style in Safari.\n   */\n\n  [type='search'] {\n    -webkit-appearance: textfield; /* 1 */\n    outline-offset: -2px; /* 2 */\n  }\n\n  /**\n   * Remove the inner padding in Chrome and Safari on macOS.\n   */\n\n  [type='search']::-webkit-search-decoration {\n    -webkit-appearance: none;\n  }\n\n  /**\n   * 1. Correct the inability to style clickable types in iOS and Safari.\n   * 2. Change font properties to \"inherit\" in Safari.\n   */\n\n  ::-webkit-file-upload-button {\n    -webkit-appearance: button; /* 1 */\n    font: inherit; /* 2 */\n  }\n\n  /* Interactive\n    ========================================================================== */\n\n  /*\n  * Add the correct display in Edge, IE 10+, and Firefox.\n  */\n\n  details {\n    display: block;\n  }\n\n  /*\n  * Add the correct display in all browsers.\n  */\n\n  summary {\n    display: list-item;\n  }\n\n  /* Misc\n    ========================================================================== */\n\n  /**\n   * Add the correct display in IE 10+.\n   */\n\n  template {\n    display: none;\n  }\n\n  /**\n   * Add the correct display in IE 10.\n   */\n\n  [hidden] {\n    display: none;\n  }\n`;\n","import { createGlobalStyle } from 'styled-components';\n\nimport { normalizeCss } from './normalizeCss';\n\nexport const GlobalStyle = createGlobalStyle`\n  ${normalizeCss};\n\n  html, body {\n    font-family: Lucida Console, Courier, monospace;\n    color: black;\n    font-size: 10px;\n  }\n\n  html {\n    box-sizing: border-box;\n  }\n\n  *, *:before, *:after {\n    box-sizing: inherit;\n  }\n`;\n","import styled from 'styled-components';\n\ntype ButtonProps = {\n  hide?: boolean;\n};\n\nexport const Button = styled.button<ButtonProps>`\n  background-color: black;\n  color: white;\n  outline: none;\n  border: none;\n  padding: 1vh 2vh;\n  font-size: 1.5vh;\n  display: ${props => props.hide ? \"none\" : \"default\"}\n`;\n","export default __webpack_public_path__ + \"static/media/logo.f8f94c84.svg\";","import React from 'react';\nimport styled from 'styled-components';\n\nimport { Button } from '../Button/Button';\n\nimport logo from '../../assets/logo.svg';\n\nconst LogoPlay = styled.div`\n  width: 95%;\n  margin-left: 2%;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 2.5vh 2vw 2vh 2vw;\n  img {\n    max-width: 200px;\n  }\n`;\n\ninterface HeaderProps {\n  onClickButton: () => any;\n  hideButton: boolean;\n}\n\nexport function Header({\n  onClickButton,\n  hideButton,\n}: HeaderProps) {\n  return (\n    <LogoPlay>\n      <a href=\"/\"><img src={logo} /></a>\n      <Button hide={hideButton} onClick={onClickButton}>Play Now</Button>\n    </LogoPlay>\n  );\n};","import React, { useCallback, memo, FC, useRef, useState } from 'react';\nimport styled from 'styled-components';\n\nimport { Button } from '../Button/Button';\n\nimport logo from '../../assets/logo.svg';\n\nconst CenteredFooter = styled.div`\nwidth: 100%;\nfont-weight: 600;\ndisplay: flex;\njustify-content: center;\nalign-items: center;\nfont-size: 1.5vh;\nmargin-top: 5vh;\na {\n  color: #5BA02D;\n  &:visited {\n    color: #5BA02D;\n  }\n}\n`;\n\nexport const Footer: FC = memo(function Footer() {\n  return (\n    <CenteredFooter>\n      <span>Made with WebRTC and ðŸ’– by <a href=\"https://arora-aditya.com\" target=\"_blank\">Aditya Arora</a></span>\n    </CenteredFooter>\n  );\n});","export enum MESSAGE_SENDER {\n  ME = 'ME',\n  STRANGER = 'FRIEND',\n}\n","export enum MESSAGE_TYPE {\n  TEXT = 'TEXT',\n  MOVE = 'MOVE',\n}\n","import React, { useState, useCallback, createContext, FC, useContext, useEffect } from 'react';\nimport { ReplaySubject } from 'rxjs';\n\nimport { ChatMessageType } from '../../types/ChatMessageType';\n\nconst chatMessagesSubject = new ReplaySubject<ChatMessageType>();\n\nconst ChatMessagesContext = createContext(chatMessagesSubject);\n\nexport const ChatMessagesProvider: FC = ({ children }) => {\n  return <ChatMessagesContext.Provider value={chatMessagesSubject}>{children}</ChatMessagesContext.Provider>;\n};\n\nexport const useChatMessages = () => {\n  const chatMessagesSubject = useContext(ChatMessagesContext);\n  const [chatMessages, setChatMessages] = useState<ChatMessageType[]>([]);\n\n  useEffect(() => {\n    const subscription = chatMessagesSubject.subscribe((chatMessage) => {\n      setChatMessages((chatMessages) => [...chatMessages, chatMessage]);\n    });\n\n    return () => subscription.unsubscribe();\n  }, [chatMessagesSubject, setChatMessages]);\n\n  const sendChatMessage = useCallback(\n    (chatMessage: ChatMessageType) => {\n      chatMessagesSubject.next(chatMessage);\n    },\n    [chatMessagesSubject],\n  );\n\n  return { chatMessages, sendChatMessage };\n};\n","import { useCallback } from 'react';\nimport shortid from 'shortid';\n\nimport { MessageType, MessageTextType } from '../../types/MessageType';\nimport { usePeerConnection, usePeerConnectionSubscription } from '../PeerConnection/PeerConnection';\nimport { MESSAGE_SENDER } from '../../types/MessageSenderEnum';\nimport { MESSAGE_TYPE } from '../../types/MessageTypeEnum';\nimport { useChatMessages } from '../ChatMessages/ChatMessages';\nimport { ChatMessageType } from '../../types/ChatMessageType';\n\nexport const useChat = () => {\n  const { chatMessages, sendChatMessage } = useChatMessages();\n\n  const {\n    mode,\n    isConnected,\n    localConnectionDescription,\n    startAsHost,\n    startAsSlave,\n    setRemoteConnectionDescription,\n    sendMessage,\n  } = usePeerConnection<ChatMessageType>();\n\n  const sendTextChatMessage = useCallback(\n    (messageText: string) => {\n      const message: MessageTextType = {\n        id: shortid.generate(),\n        sender: MESSAGE_SENDER.STRANGER,\n        type: MESSAGE_TYPE.TEXT,\n        timestamp: +new Date(),\n        payload: messageText,\n      };\n\n      sendMessage(message);\n      sendChatMessage({\n        id: message.id,\n        sender: MESSAGE_SENDER.ME,\n        timestamp: message.timestamp,\n        text: message.payload,\n      });\n    },\n    [sendMessage, sendChatMessage],\n  );\n\n  return {\n    mode,\n    isConnected,\n    localConnectionDescription,\n    chatMessages,\n    startAsHost,\n    startAsSlave,\n    setRemoteConnectionDescription,\n    sendTextChatMessage,\n  };\n};\n\n// This hook should be used only in one place since it's connecting Chat to PeerConnection\nexport const useChatPeerConnectionSubscription = () => {\n  const { sendChatMessage } = useChatMessages();\n\n  const onMessageReceived = useCallback(\n    (message: MessageType) => {\n      if (message.type === MESSAGE_TYPE.TEXT) {\n        sendChatMessage({\n          id: message.id,\n          sender: MESSAGE_SENDER.STRANGER,\n          timestamp: message.timestamp,\n          text: message.payload,\n        });\n      }\n    },\n    [sendChatMessage],\n  );\n\n  usePeerConnectionSubscription(onMessageReceived);\n};\n","import React, { FC, memo } from 'react';\nimport styled from 'styled-components';\n\nimport { MESSAGE_SENDER } from '../../types/MessageSenderEnum';\nimport { ChatMessageType } from '../../types/ChatMessageType';\n\nconst Text = styled.div``;\nconst Header = styled.div`\n`;\nconst Message = styled.div`\n`;\n\nconst ChatTextMessage: FC<Props> = memo(function ChatTextMessage({ chatMessage }) {\n  return (\n    <Message>\n      <Header>\n        <span>{chatMessage.sender === MESSAGE_SENDER.ME ? 'Me' : 'Friend'}</span> (\n        {new Date(chatMessage.timestamp).toLocaleTimeString()})\n      </Header>\n      <Text>{chatMessage.text}</Text>\n    </Message>\n  );\n});\n\ninterface Props {\n  chatMessage: ChatMessageType;\n}\n\nexport const ChatMessage: FC<Props> = memo(function ChatMessage({ chatMessage }) {\n  return <ChatTextMessage chatMessage={chatMessage} />;\n});\n","import styled from 'styled-components';\n\nexport const TextArea = styled.textarea`\n  display: block;\n  font-size: 10px;\n  width: 100%;\n  height: 30px;\n  border: 1px solid black;\n  outline: none;\n  background-image: none;\n  appearance: none;\n  background-color: transparent;\n  box-shadow: none;\n`;\n","import React, { useCallback, memo, FC, useRef, useState } from 'react';\nimport styled from 'styled-components';\n\nimport { useChat } from '../../module/useChat/useChat';\nimport { ChatMessage } from './ChatMessage';\nimport { TextArea } from '../TextArea/TextArea';\nimport { Button } from '../Button/Button';\n\nconst MessageButton = styled(Button)`\n`;\nconst MessageTextArea = styled(TextArea)`\n`;\nconst MessageForm = styled.form`\n`;\nconst MessagesInnerContainer = styled.div`\n`;\nconst MessagesContainer = styled.div`\n`;\nconst Container = styled.div`\n`;\n\nexport const Chat: FC = memo(function Chat() {\n  const { chatMessages, sendTextChatMessage } = useChat();\n  const [messageToSend, setMessageToSend] = useState<string>('');\n  const formRef = useRef<HTMLFormElement>();\n\n  const send = useCallback(() => {\n    sendTextChatMessage(messageToSend);\n    setMessageToSend('');\n  }, [sendTextChatMessage, messageToSend, setMessageToSend]);\n\n  const handleTextAreaChange: React.ChangeEventHandler<HTMLTextAreaElement> = useCallback(\n    (event) => {\n      event.preventDefault();\n      event.stopPropagation();\n      setMessageToSend(event.target.value);\n    },\n    [setMessageToSend],\n  );\n\n  const handleTextAreaKeyDown: React.KeyboardEventHandler<HTMLTextAreaElement> = useCallback(\n    (event) => {\n      if ((event.which !== 13 && event.keyCode !== 13) || event.shiftKey) return;\n      if (!formRef.current) return;\n\n      event.preventDefault();\n      event.stopPropagation();\n      send();\n    },\n    [send],\n  );\n\n  const handleSubmit: React.FormEventHandler = useCallback(\n    (event) => {\n      event.preventDefault();\n      event.stopPropagation();\n      send();\n    },\n    [send],\n  );\n\n  return (\n    <Container>\n      <MessagesContainer>\n        <MessagesInnerContainer>\n          {chatMessages.map((chatMessage) => (\n            <ChatMessage key={chatMessage.id} chatMessage={chatMessage} />\n          ))}\n        </MessagesInnerContainer>\n      </MessagesContainer>\n      <MessageForm ref={formRef as React.MutableRefObject<HTMLFormElement>} onSubmit={handleSubmit}>\n        <MessageTextArea\n          placeholder=\"Message...\"\n          value={messageToSend}\n          onChange={handleTextAreaChange}\n          onKeyDown={handleTextAreaKeyDown}\n        />\n        <MessageButton type=\"submit\">Send</MessageButton>\n      </MessageForm>\n    </Container>\n  );\n});\n","import { createValidator } from 'schemat';\n\nconst nonEmptyStringValidator = (d: any) => (typeof d === 'string' && d.length > 0 ? undefined : 'required');\n\nexport const connectionDescriptionValidator = createValidator({\n  description: nonEmptyStringValidator,\n});\n","import { Base64 } from 'js-base64';\n\nimport { ConnectionDescription } from '../module/PeerConnection/PeerConnection';\n\nexport function encode(connectionDescription: ConnectionDescription): string {\n  return Base64.encode(JSON.stringify(connectionDescription));\n}\n\nexport function decode(connectionDescriptionCode: string): ConnectionDescription {\n  return JSON.parse(Base64.decode(connectionDescriptionCode));\n}\n","import React, { FC, useState, MouseEventHandler, ChangeEventHandler, FormEventHandler, memo } from 'react';\nimport styled from 'styled-components';\n\nimport { connectionDescriptionValidator } from '../../util/connectionDescriptionValidator';\nimport { decode } from '../../util/connectionDescriptionEncoding';\nimport { Button } from '../Button/Button';\nimport { TextArea } from '../TextArea/TextArea';\nimport { useChat } from '../../module/useChat/useChat';\nimport { ConnectionDescription } from '../../module/PeerConnection/PeerConnection';\n\nconst InvitationTextArea = styled(TextArea)`\n  width: 100px;\n`;\nconst HostButton = styled(Button)`\n  width: 100px;\n`;\nconst SlaveButton = styled(Button)`\n  width: 100px;\n  margin-top: 4px;\n`;\nconst ErrorMessage = styled.div``;\nconst Form = styled.form`\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n`;\nconst Card = styled.div`\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n`;\n\nconst CardContainer = styled.div`\n  position: relative;\n  display: flex;\n  width: 100%;\n  height: 200px;\n  align-items: stretch;\n  border: 1px solid black;\n  border-top: none;\n\n  > ${Card} {\n    width: 100%;\n    border-left: 1px solid black;\n\n    &:first-child {\n      border-left: none;\n    }\n  }\n`;\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n`;\n\nconst ModalContainer = styled.div`\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  justify-content: space-around;\n`;\n\nconst ModalHalf = styled.div`\n  font-size: 1.5vh;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  button {\n    margin: 1vh;\n    width: fit-content;\n  }\n  hr {\n    width: 90%;\n  }\n  textarea {\n  }\n`;\n\nconst Or = styled.div`\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  text-align: center;\n  width: 4vh;\n  height: 4vh;\n  font-size: 1.5vh;\n  background-color: black;\n  color: white;\n  border-radius: 50%;\n  transform: translate(0px, -2.5vh);\n  > span {\n    transform: translate(0.5px, -1.5px);\n    line-height: 1;\n  }\n`\n\nexport const HostOrSlave: FC = memo(function HostOrSlave() {\n  const { startAsHost, startAsSlave } = useChat();\n  const [connectionDescription, setConnectionDescription] = React.useState<string>('');\n  const [error, setError] = useState<string>('');\n\n  const handleHostBtnClick: MouseEventHandler<HTMLButtonElement> = (event) => {\n    event.preventDefault();\n    event.stopPropagation();\n    startAsHost();\n  };\n\n  const handleConnectionDescriptionInputChange: ChangeEventHandler<HTMLTextAreaElement> = (event) => {\n    event.preventDefault();\n    event.stopPropagation();\n    setError('');\n    setConnectionDescription(event.target.value);\n  };\n\n  const handleSlaveFormSubmit: FormEventHandler = (event) => {\n    event.preventDefault();\n    event.stopPropagation();\n\n    try {\n      const connectionDescriptionObject = decode(connectionDescription);\n      if (connectionDescriptionValidator(connectionDescriptionObject)) throw new Error();\n      startAsSlave(connectionDescriptionObject as ConnectionDescription);\n    } catch (error) {\n      setError('Connection Description invalid!');\n    }\n  };\n\n  return (\n      <ModalContainer>\n        <ModalHalf>\n          <Button onClick={handleHostBtnClick}>Start new</Button>\n        </ModalHalf>\n        <ModalHalf>\n          <hr />  \n          <Or><span>or</span></Or>\n        </ModalHalf>\n        <ModalHalf>\n        <Form onSubmit={handleSlaveFormSubmit}>\n          <InvitationTextArea \n            value={connectionDescription}\n            onChange={handleConnectionDescriptionInputChange}\n            placeholder=\"Paste invitation code here...\"/>\n            {!!error && <ErrorMessage>{error}</ErrorMessage>}\n            <SlaveButton type=\"submit\">Join</SlaveButton>\n          </Form>\n        </ModalHalf>\n      </ModalContainer>\n  );\n});\n","import React, { useState, createRef, FC, memo } from 'react';\nimport styled from 'styled-components';\nimport copy from 'copy-to-clipboard';\n\nimport { encode, decode } from '../../util/connectionDescriptionEncoding';\nimport { connectionDescriptionValidator } from '../../util/connectionDescriptionValidator';\nimport { TextArea } from '../TextArea/TextArea';\nimport { Button } from '../Button/Button';\nimport { useChat } from '../../module/useChat/useChat';\nimport { ConnectionDescription } from '../../module/PeerConnection/PeerConnection';\n\nconst ErrorMessage = styled.div``;\nconst StyledTextArea = styled(TextArea)`\n  margin-bottom: 1vh;\n`;\nconst ConnectButton = styled(Button)`\n`;\nconst CopyButton = styled(Button)`\n  width: 70%;\n  margin-top: 4px;\n`;\nconst Form = styled.form`\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n`;\nconst Instruction = styled.div`\n  color: black;\n  margin-bottom: 1vh;\n  margin-top: 1vh;\n`;\nconst Step = styled.div`\n  position: absolute;\n  top: 8px;\n  left: 8px;\n  width: 2vh;\n  height: 2vh;\n  background-color: black;\n  color: white;\n  border-radius: 50%;\n  line-height: 1;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  text-align: center;\n\n  > span {\n    display: inline-block;\n    // transform: translate(-0.2vh, -0.2vh);\n  }\n`;\nconst Card = styled.div`\n  position: relative;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 24px;\n  border-top: none;\n`;\nconst Container = styled.div`\n  width: 100%;\n  height: 100%;\n  display: flex;\n  font-size: 1.5vh;\n  flex-direction: column;\n  justify-content: space-around;\n`;\n\nexport interface HostProps {\n  connectionDescription: ConnectionDescription;\n  onSubmit: (remoteConnectionDescription: ConnectionDescription) => any;\n}\n\nexport const Host: FC = memo(function Host() {\n  const { localConnectionDescription, setRemoteConnectionDescription } = useChat();\n  const [remoteConnectionDescriptionInputValue, setRemoteConnectionDescriptionInputValue] = useState<string>('');\n  const [error, setError] = useState<string>('');\n  const copyTextAreaRef = createRef<HTMLTextAreaElement>();\n\n  const encodedConnectionDescription = encode(localConnectionDescription as ConnectionDescription);\n\n  const handleCopyClick = () => {\n    if (!copyTextAreaRef.current) return;\n\n    copyTextAreaRef.current.select();\n    copy(encodedConnectionDescription);\n  };\n\n  const handleRemoteConnectionDescriptionInputChange: React.ChangeEventHandler<HTMLTextAreaElement> = (event) => {\n    event.preventDefault();\n    event.stopPropagation();\n    setError('');\n    setRemoteConnectionDescriptionInputValue(event.target.value);\n  };\n\n  const handleSubmit: React.FormEventHandler = (event) => {\n    try {\n      event.stopPropagation();\n      event.preventDefault();\n      const connectionDescriptionObject = decode(remoteConnectionDescriptionInputValue);\n      if (connectionDescriptionValidator(connectionDescriptionObject)) throw new Error();\n      setRemoteConnectionDescription(connectionDescriptionObject as ConnectionDescription);\n    } catch (error) {\n      setError('Connection Description invalid!');\n    }\n  };\n\n  return (\n    <Container>\n      <Card>\n        <Step>\n          <span>1</span>\n        </Step>\n        <Instruction>Send this code to your buddy:</Instruction>\n        <StyledTextArea ref={copyTextAreaRef} value={encodedConnectionDescription} readOnly />\n        <Button onClick={handleCopyClick}>Copy to clipboard</Button>\n      </Card>\n      <Card>\n        <Step>\n          <span>2</span>\n        </Step>\n        <Form onSubmit={handleSubmit}>\n          <Instruction>Code from your buddy:</Instruction>\n          <StyledTextArea\n            value={remoteConnectionDescriptionInputValue}\n            onChange={handleRemoteConnectionDescriptionInputChange}\n            placeholder=\"Paste an answer code\"\n          />\n          <Button type=\"submit\">Connect</Button>\n        </Form>\n        {!!error && <ErrorMessage>{error}</ErrorMessage>}\n      </Card>\n    </Container>\n  );\n});\n","import React, { FC, createRef, memo } from 'react';\nimport styled from 'styled-components';\nimport copy from 'copy-to-clipboard';\n\nimport { encode } from '../../util/connectionDescriptionEncoding';\nimport { Button } from '../Button/Button';\nimport { TextArea } from '../TextArea/TextArea';\nimport { useChat } from '../../module/useChat/useChat';\nimport { ConnectionDescription } from '../../module/PeerConnection/PeerConnection';\n\nconst CopyButton = styled(Button)`\n  margin-top: 1vh;\n`;\nconst StyledTextArea = styled(TextArea)`\n  width: 70%;\n`;\nconst Instruction = styled.div`\n  font-size: 1.5vh;\n  color: black;\n  margin-bottom: 1vh;\n`;\nconst Card = styled.div`\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 24px;\n`;\nconst Container = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  height: 100%;\n`;\n\nexport const Slave: FC = memo(function Slave() {\n  const { localConnectionDescription } = useChat();\n  const copyTextAreaRef = createRef<HTMLTextAreaElement>();\n\n  const encodedConnectionDescription = encode(localConnectionDescription as ConnectionDescription);\n\n  const handleCopyClick = () => {\n    if (!copyTextAreaRef.current) return;\n\n    copyTextAreaRef.current.select();\n    copy(encodedConnectionDescription);\n  };\n\n  return (\n    <Container>\n      <Card>\n        <Instruction>Send back this code back to your friend</Instruction>\n        <StyledTextArea ref={copyTextAreaRef} value={encodedConnectionDescription} readOnly />\n        <CopyButton onClick={handleCopyClick}>Copy to clipboard</CopyButton>\n      </Card>\n    </Container>\n  );\n});\n","export default __webpack_public_path__ + \"static/media/message_undraw.58f7be79.svg\";","export default __webpack_public_path__ + \"static/media/share_undraw.8870c8da.svg\";","import React, { useState, memo, FC } from 'react';\nimport styled from 'styled-components';\nimport Modal from 'react-modal';\n\nimport { Button } from './components/Button/Button';\nimport { Header } from './components/Header/Header';\nimport { Footer } from './components/Footer/Footer';\nimport { Chat } from './components/Chat/Chat';\nimport { Chess } from './components/Chess/Chess';\nimport { HostOrSlave } from './components/HostOrSlave/HostOrSlave';\nimport { Host } from './components/Host/Host';\nimport { Slave } from './components/Slave/Slave';\nimport { useChat, useChatPeerConnectionSubscription } from './module/useChat/useChat';\nimport { PEER_CONNECTION_MODE } from './module/PeerConnection/PeerConnection';\n\nimport message from './assets/message_undraw.svg';\nimport share from './assets/share_undraw.svg';\n\nconst InnerWrapper = styled.div`\n`;\nconst Wrapper = styled.div`\n`;\n\n\ntype FlexContainerProps = {\n  reversed?: boolean;\n};\n\nconst FlexContainer = styled.div<FlexContainerProps>`\n  margin-left: 5%;\n  width: 90%;\n  display: flex;\n  align-items: center;\n  justify-items: space-between;\n  justify-content: center;\n  flex-direction: column;\n  @media (min-width: 768px) {\n    flex-direction: ${props => props.reversed ? \"row-reverse\" : \"row\"}\n  }\n  img {\n    width: 80%;\n    @media (min-width: 768px) {\n      width: 70%;\n    }\n    margin-top: 5vh;\n    margin-bottom: 5vh;\n  }\n`;\n\nconst TextContainer = styled.div`\n  width: 100%;\n  @media (min-width: 768px) {\n    width: 60%;\n  }\n  font-size: 2vh;\n  margin: 2vh;\n  margin-left: 5vh;\n  margin-bottom: 5vh;\n  font-weight: 900;\n  @media only screen and (max-width: 900px){\n    width: 70%;\n  }\n`;\n\nconst StepContainer = styled.div`\n  width: 100%;\n  @media (min-width: 768px) {\n    width: 60%;\n  }\n  font-size: 2vh;\n  margin: 2vh;\n  margin-left: 5vh;\n  margin-bottom: 5vh;\n  font-weight: 900;\n  @media only screen and (max-width: 900px){\n    width: 70%;\n  }\n`;\n\nconst App: FC = memo(function App() {\n  const { mode, isConnected } = useChat();\n  const [isModalOpen, setModalOpen] = useState(false);\n  useChatPeerConnectionSubscription();\n  return (\n    <Wrapper>\n    <Header onClickButton={() => setModalOpen(true)} hideButton={isConnected}/>\n    {!isConnected && \n      <InnerWrapper>\n        <FlexContainer>\n          <TextContainer>\n            Serverless Chess with friends with the ability to analyse and share games!\n          </TextContainer>\n          <img src={message} />\n        </FlexContainer>\n        <FlexContainer reversed={true}>\n          <TextContainer>\n            Simply share the invite codes between devices and instantly start playing!<br/>\n            No data recorded anywhere!\n          </TextContainer>\n          <img src={share} />\n        </FlexContainer>\n        <Modal\n          style={{content: {\n            height: \"50%\", \n            top: '50%',\n            left: '50%',\n            right: 'auto',\n            bottom: 'auto',\n            padding: '3vh 3vh',\n            marginRight: '-50%',\n            transform: 'translate(-50%, -50%)'}}}\n          isOpen={isModalOpen}\n          onRequestClose={() => setModalOpen(false)}\n          contentLabel=\"Start New or Join\"\n        >\n            {!mode && <HostOrSlave />}\n            {mode === PEER_CONNECTION_MODE.HOST && !isConnected && <Host />}\n            {mode === PEER_CONNECTION_MODE.SLAVE && !isConnected && <Slave />}\n        </Modal>\n      </InnerWrapper>\n      \n    }\n      {mode && isConnected && <Chat />}\n      <Footer />\n    </Wrapper>\n  );\n});\n\nexport default App;\n\n// {!mode && <HostOrSlave />}\n// {mode === PEER_CONNECTION_MODE.HOST && !isConnected && <Host />}\n// {mode === PEER_CONNECTION_MODE.SLAVE && !isConnected && <Slave />}\n// {mode && isConnected && <Chat />}","import React, { Fragment } from 'react';\nimport ReactDOM from 'react-dom';\n\nimport { PeerConnectionProvider } from './module/PeerConnection/PeerConnection';\nimport { GlobalStyle } from './styles/globalStyle';\nimport App from './App';\n\nReactDOM.render(\n  <PeerConnectionProvider>\n      <Fragment>\n        <GlobalStyle />\n        <App />\n      </Fragment>\n  </PeerConnectionProvider>,\n  document.getElementById('root'),\n);\n"],"sourceRoot":""}